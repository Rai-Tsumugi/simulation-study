# シミュレーションプログラム

---

### 作成した順番
- ProfitMaximization
- linear-solver-bisection
- montecarlo-pi
- daphnia-fish-balance
- dam-flood-simulation
- bungee
- strage

---

## ProfitMaximization
> このプログラムは、Google OR-Tools を使って**線形計画問題（LP）**を解くサンプルです。

#### 🔍 何をするプログラムか
制約条件の下で、目的関数 $4x + 3y$ を最大化するような実数変数 $x, y \ge 0$ の値を線形計画法で求める。

#### ⚙️ モデルの内容
- **変数**
  - $x \ge 0, y \ge 0$
- **制約条件**
  - $3x + 2y \le 30$
  - $10x + 15y \le 150$
- **目的関数**
  - maximize $4x + 3y$

#### ✅ 使用技術
- Google OR-Tools（GLOP solver）
- API: `MPSolver`, `MPVariable`, `MPConstraint`, `MPObjective`

#### 🧾 出力例（期待値）
```makefile
Solution:
Objective value = 50.0
x = 10.0
y = 0.0
```

---

## linear-solver-bisection

このプログラムは、一次関数の逆関数的な値（x）を2分法で求めるシンプルな数値解法です。

#### 🔍 プログラムの目的
関数 $f(x) = -2x + 6$ に対し、 $f(x) = \text{targetY}$ を満たす $x$ を2分法で求める。

#### 🧠 方法
$g(x) = f(x) - \text{targetY}$ と定義し、$g(x) = 0$ を解く。  
解が存在する区間 $[a, b]$ に対して2分法（bisection method）を適用する。

#### ✅ 処理の流れ

- $[a, b]$ を初期化
- $g(a)$ と $g(b)$ の符号が異なることを確認
- 中点 $c = \dfrac{a + b}{2}$ を評価
- $g(c)$ の符号によって区間を絞り込み
- 区間の幅が $\epsilon$ 未満になるまで繰り返す

#### 📘 実行例（targetY = 5）

- 理論解： $x = \dfrac{6 - 5}{2} = 0.5$
- 出力： $x \approx 0.500000$

---

## montecarlo-pi

このプログラムは、モンテカルロ法を使って $\pi$（円周率）を推定し、収束の様子を対数スケールで可視化します。

#### 🔍 目的

単位正方形に乱数で点を打ち、1/4 円内に入った割合から $\pi$ を近似。  
経過ごとに推定値をプロットして収束性を観察します。

#### ⚙️ モデルの仕組み

- 推定式：
  $$
  \pi \approx 4 \times \left( \frac{\text{円内の点数}}{\text{総点数}} \right)
  $$
- サンプル数は **対数スケール**で増加させて、初期の変動と後半の収束を両方見やすく調整。
- **JFreeChart** による可視化：
  - **X軸**：対数目盛
  - **Y軸**：$\pi$ 周辺（3.10 〜 3.18）に制限
  - **基準線**：$\pi \approx 3.14159$ を赤線で表示

#### 📈 推定の特徴

- 初期は大きくばらつくが、
- サンプル数が増加すると徐々に $\pi$ に収束していく様子が視覚的に確認できる。
- 数百万サンプルを超えると、誤差は 0.01 以下に。

---

## daphnia-fish-balance

このプログラムは、ミジンコと魚の個体数の相互関係（捕食・繁殖）をシミュレーションし、グラフ表示します。

#### 🔍 目的

ミジンコ（Daphnia）と魚（Fish）による生態系モデルを  
時間経過とともに可視化する。

#### ⚙️ モデル概要

- **ミジンコ（Daphnia）**
  - 増加：出生率 50%
  - 減少：魚による捕食（5% × 魚数）

- **魚（Fish）**
  - 増加：ミジンコ捕食による繁殖（0.3%）
  - 減少：自然死（30%）

- **数式（オイラー法）**
  ```plaintext
  daphnia(t+dt) = daphnia + dt * (0.5*daphnia - 0.05*fish*daphnia)
  fish(t+dt)    = fish + dt * (0.003*daphnia*fish - 0.3*fish)
  ```

#### 📈 可視化

-XYSeries で時系列データを記録
-JFreeChart による折れ線グラフで表示
-ステップ間隔：0.01
-シミュレーション時間：100 ステップ分

---

## dam-flood-simulation

このプログラムは、ダムの水位をシミュレーションし、貯水・流入・放流のバランスを分析します。

#### 🔍 目的

- ランダムな流入量と、水位依存の放流量による水位変化を追跡  
- ダムの枯渇や溢水（決壊）を検知する

#### ⚙️ 特徴

✅ **流入量（確率分布）**

```Plaintext
値：{0.0, 0.5, 1.0, 1.5, 2.0, 5.0}
確率：{0.1, 0.6, 0.2, 0.05, 0.03, 0.02}
```

✅ **放流量（非線形）**

- 水位が低い → `minOutflowRate = 0.2`  
- 水位が高い → `maxOutflowRate = 2.0`  
- 中間域 → 水位に応じて放物線的に増加（指数 2.0）

✅ **水位更新**

- 毎日：`水位 += 流入 - 放流`  
- 水位が上限を超えるとダム決壊（以降 `水位 = 0`）

#### 📈 出力

- 各日の流入・放流・水位を `System.out.printf` で標準出力  
- `DamChart` によるグラフ表示（JFreeChart 使用）

---

## bungee

このプログラムは、重力・バネ・空気抵抗によるバンジージャンプ運動を数値的に再現するものです。

#### 🔍 目的

落下運動をルンゲ＝クッタ法（RK4）で解き、  
位置・速度・加速度の時間変化を出力・可視化します。

#### ⚙️ モデル構成

- **重力**：定数 $9.8 \, \text{m/s}^2$
- **ばね力**：自然長を超えたときに復元力（フックの法則）
- **空気抵抗**：速度の2乗に比例し、常に逆向きに働く

#### ✅ 数値計算

- 使用手法：**RK4法（4次ルンゲ＝クッタ法）**
- シミュレーション停止条件：
  - 地面に到達
  - 加速度が $1.5G$ を超過（安全性考慮）

#### 📈 出力

- 各時刻の：
  - 時間（秒）
  - 現在位置（m）
  - 速度（m/s）
  - 合成加速度／重力加速度（$a/G$）
- `BungeeChart` によりグラフ表示（JFreeChart 利用）

---

## strage

このプログラムは、確率的な販売量と定期的な発注に基づいて在庫を管理するシミュレーションです。

#### 🔍 目的

正規分布に従う販売量と 5 日ごとの自動発注により在庫の推移を再現し、  
以下の項目を可視化します：

- 在庫不足  
- 機会損失  
- 過剰在庫

#### ⚙️ モデル構成

| 要素       | 設定値       | 説明                              |
|------------|--------------|-----------------------------------|
| 初期在庫   | 100          | 開始時の在庫数                    |
| 最大在庫   | 200          | 上限を超えると制限                |
| 発注間隔   | 5日ごと      | 自動発注タイミング                |
| 販売量     | 平均 25, SD 10 | $N(25, 10^2)$ に従う正規分布     |
| 期間       | 365日        | 1年分のシミュレーション           |

#### 📈 出力（毎日）

```plaintext
日数:  34, 発注:  52, 販売:  21, 在庫: 173
```

📊 集計結果

```Plaintext
=== シミュレーション結果 ===
在庫不足回数: 3
在庫不足量(機会損失): 57
在庫不足率: 0.82%
在庫過剰回数: 4
最大在庫量: 200
平均在庫量: 132.42
```

StrageChart による時系列グラフ付き
Google スプレッドシートへのエクスポート対応（別途処理）
